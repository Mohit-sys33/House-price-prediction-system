{% extends "layout.html" %}
{% block content %}
<div style="max-width: 500px; margin: auto; text-align: center; padding: 40px;">
  <h2>ðŸšª Signed Out Successfully</h2>
  <p>You have been logged out.</p>
  <a href="/login" style="display: inline-block; margin-top: 20px; padding: 10px 20px; background: #1976d2; color: white; text-decoration: none; border-radius: 6px;">Sign In Again</a>
</div>

<script
  async
  crossorigin="anonymous"
  data-clerk-publishable-key="{{ clerk_publishable_key }}"
  src="https://whole-ewe-33.clerk.accounts.dev/npm/@clerk/clerk-js@5.102.0/dist/clerk.browser.js"
  type="text/javascript">
</script>

<script>
// Set a flag to prevent redirect loops
sessionStorage.setItem('logging_out', 'true');

window.addEventListener("load", async () => {
  console.log("ðŸ”„ Loading Clerk for sign out...");
  
  try {
    await Clerk.load();
    console.log("ðŸšª Signing out from Clerk...");
    
    // Sign out from Clerk silently
    if (Clerk.user) {
      await Clerk.signOut({ 
        sessionId: Clerk.session?.id 
      });
      console.log("âœ… Clerk sign out complete");
    }
  } catch (error) {
    console.error("Error signing out:", error);
  }
  
  // Clear the flag after a moment
  setTimeout(() => {
    sessionStorage.removeItem('logging_out');
  }, 1000);
});
</script>
{% endblock %}
